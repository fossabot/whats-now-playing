
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>TwitchBot &#8212; What&#39;s Now Playing 0+untagged.1.g71e73c1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Webserver" href="webserver.html" />
    <link rel="prev" title="OBS WebSocket Plug-in" href="obswebsocket.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="twitchbot">
<h1>TwitchBot<a class="headerlink" href="#twitchbot" title="Permalink to this heading">¶</a></h1>
<p><strong>What’s Now Playing</strong> integrates with Twitch with channel point redemptions and/or chat.  They
may be run independently or run both at the same time.</p>
<section id="twitch-chat-support">
<h2>Twitch Chat Support<a class="headerlink" href="#twitch-chat-support" title="Permalink to this heading">¶</a></h2>
<p>The chat bot support includes track announcement as well as interactive features.</p>
<p>For example, in chat, if the user types:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!track
</pre></div>
</div>
<p><strong>What’s Now Playing</strong> will read a file called <code class="docutils literal notranslate"><span class="pre">twitchbot_track.txt</span></code> and expand any
template values in it.  The Twitchbot settings section sets permissions
for commands.</p>
<p>Additionally, the Twitchbot can send an announcement template to chat when <strong>What’s Now Playing</strong> detects a song change
or when a track Request has been fulfilled.</p>
</section>
<section id="twitch-channel-point-redemptions">
<h2>Twitch Channel Point Redemptions<a class="headerlink" href="#twitch-channel-point-redemptions" title="Permalink to this heading">¶</a></h2>
<p>Currently, channel point redemptions allow for users to request songs, either by
artist/title or picking a random song in a ‘roulette’ mode when that redemption
is tied to a supported DJ’s software crate/playlist.  For more information see
<a class="reference external" href="../requests/">Requests</a>.</p>
</section>
<section id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this heading">¶</a></h2>
<p>You can choose to either use your own account or create a new account for your bot.  It is generally recommended
to create a new account and these instructions are following those guidelines.</p>
<ol class="arabic simple">
<li><p>Follow the Twitch process for creating a new account.</p></li>
<li><p>On the new account, be sure to enable:</p>
<ul class="simple">
<li><p>Multiple logins per email</p></li>
<li><p>Two-factor authentication (2FA)</p></li>
</ul>
</li>
</ol>
<a class="reference external image-reference" href="images/twitchbot-account-settings.png"><img alt="Account Settings for bots" src="../_images/twitchbot-account-settings.png" /></a>
<ol class="arabic simple">
<li><p>Go to <a class="reference external" href="https://dev.twitch.tv">Twitch Dev Settings</a> to
register <strong>What’s Now Playing</strong>.</p>
<ol class="arabic simple">
<li><p>Click Login in the upper right</p></li>
<li><p>Click on “Your Console” in the upper right</p></li>
<li><p>Click on “Applications”</p></li>
<li><p>Click on “Register Your Application”</p></li>
<li><p>Name: login name used by the bot account</p></li>
<li><p>OAuth Redirect URLs: <a class="reference external" href="http://localhost:17563">http://localhost:17563</a></p></li>
<li><p>Category: Chat Bot</p></li>
<li><p>Create</p></li>
<li><p>Click on “Manage” and save a copy of the Client ID.</p></li>
<li><p>Click on ‘New Secret’. Save a copy of the Client Secret.</p></li>
</ol>
</li>
<li><p>Get an OAuth Token:</p>
<ol class="arabic simple">
<li><p>Go to <a class="reference external" href="http://twitchapps.com/tmi">TMI</a>.</p></li>
<li><p>Authentication</p></li>
<li><p>Copy the Token down</p></li>
</ol>
</li>
<li><p>At the end of this process, you should have four pieces of information:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Your Twitch Stream/Channel:</p></li>
<li><p>Bot’s Client ID:</p></li>
<li><p>Bot’s Client Secret:</p></li>
<li><p>Bot’s Token:</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple">
<li><p>Open Settings from the <strong>What’s Now Playing</strong> icon.</p></li>
<li><p>Select Twitch from the list of settings available.</p></li>
<li><p>Fill in the information in <strong>What’s Now Playing</strong>’s  Twitch setting:</p></li>
</ol>
<a class="reference external image-reference" href="images/twitchbot_auth.png"><img alt="What's Now Playing's Twitch auth panel" src="../_images/twitchbot_auth.png" /></a>
<p>You will need to provide all four to the Twitchbot Settings.  Additionally,
you should consider making the bot a moderator on your channel to avoid limits,
such as the message posting rate, URL filters, etc.</p>
<p>For certain services, such as channel point redemptions, launching <strong>What’s Now Playing</strong>
will also launch a browser in order to authenticate the bot to your channel.</p>
</section>
<section id="twitch-chat-configuration">
<h2>Twitch Chat Configuration<a class="headerlink" href="#twitch-chat-configuration" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Open Settings from the <strong>What’s Now Playing</strong> icon</p></li>
<li><p>Select Twitch Chat from the list of settings available.</p></li>
</ol>
<a class="reference external image-reference" href="images/twitchbot_chat.png"><img alt="Twitch Chat Settings" src="../_images/twitchbot_chat.png" /></a>
<ol class="arabic simple">
<li><p>Check Enable</p></li>
<li><p>To have the bot announce new tracks in chat, select the template.</p></li>
</ol>
<p>You are now ready to set permissions on user interactive commands.</p>
<section id="setting-permissions">
<h3>Setting Permissions<a class="headerlink" href="#setting-permissions" title="Permalink to this heading">¶</a></h3>
<p>Upon launch, <strong>What’s Now Playing</strong> will create an entry for every <cite>twitchbot_*.txt</cite> file
in the template directory.  These entries will all be set to completely disabled.  In order
to enable them, you will need to check the appropriate field.</p>
<p>Twitchbot template files added while <strong>What’s Now Playing</strong> is running will let anyone
use them until the next run.  At the next run, it will again change them back to no permissions
granted.</p>
<p>Once the permissions are set and Save is clicked, those permissions will be preserved on
every restart.</p>
</section>
<section id="adding-new-commands">
<h3>Adding New Commands<a class="headerlink" href="#adding-new-commands" title="Permalink to this heading">¶</a></h3>
<p>Create a new file in <strong>What’s Now Playing</strong>’s``templates`` directory
(<code class="docutils literal notranslate"><span class="pre">Documents/Now</span> <span class="pre">Playing/template</span></code>) called <code class="docutils literal notranslate"><span class="pre">twitchbot_yourcommand.txt</span></code>
where <code class="docutils literal notranslate"><span class="pre">yourcommand</span></code> is the actual command that will be
executed by users that have the appropriate template code inside it.
Note that all text will be smashed together as a single line when sent to Twitch, so
be mindful of where to put spaces.</p>
</section>
<section id="built-in-commands">
<h3>Built-in Commands<a class="headerlink" href="#built-in-commands" title="Permalink to this heading">¶</a></h3>
<p>Post-v3.0.2, the Twitchbot will always respond to the command ‘whatsnowplayingversion’ . It
will report the version that is running.</p>
</section>
<section id="troubleshooting">
<h3>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>To test if the chat bot is working, you should be able to use the ‘!whatsnowplayingversion’
command.  <strong>What’s Now Playing</strong> only needs to be running.  You do not have to be live
streaming to test chat.</p></li>
<li><p>If the bot never connects, try getting a new OAuth token.</p></li>
<li><p>Be aware that the bot may have trouble connecting if you restart <strong>What’s Now Playing</strong> too
quickly.  It should eventually rejoin, but it may take several minutes.</p></li>
</ul>
</section>
<section id="additional-variables">
<h3>Additional Variables<a class="headerlink" href="#additional-variables" title="Permalink to this heading">¶</a></h3>
<p>The TwitchBot adds the following additional values for templating purposes:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cmduser</p></td>
<td><p>Person, bot, etc that typed the command</p></td>
</tr>
<tr class="row-odd"><td><p>cmdtarget[x]</p></td>
<td><p>The x’th target on the command, starting with 0.  For example, if the command was <cite>!so modernmeerkat</cite>,
then <cite>{{ cmdtarget[0] }}</cite> will have <cite>modernmeerkat</cite> in it. See below for an example.</p></td>
</tr>
<tr class="row-even"><td><p>startnewmessage</p></td>
<td><p>Split the text at this location and start a new message to send to chat.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="multiple-targets">
<h3>Multiple Targets<a class="headerlink" href="#multiple-targets" title="Permalink to this heading">¶</a></h3>
<p>One of the more advanced capabilities that the TwitchBot supports is a variable number of targets.  This feature
allows for your users to use one command to perform actions on, for example, multiple users.</p>
<p>A simple example. Given this template file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">@</span><span class="p">{{</span> <span class="n">cmduser</span> <span class="p">}}</span> <span class="n">hugs</span> <span class="o">@</span><span class="p">{{</span> <span class="n">cmdtarget</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">}}</span>
</pre></div>
</div>
<p>a user typing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>modernmeerkat: !hug twitch
</pre></div>
</div>
<p>Would result in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bot</span><span class="p">:</span> <span class="nd">@modernmeerkat</span> <span class="n">hugs</span> <span class="nd">@twitch</span>
</pre></div>
</div>
<p>But this can be expanded to do multiple users at once:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">@</span><span class="p">{{</span> <span class="n">cmduser</span> <span class="p">}}</span> <span class="n">sends</span> <span class="n">hugs</span> <span class="n">to</span> <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">people</span> <span class="ow">in</span> <span class="n">cmdtarget</span> <span class="o">%</span><span class="p">}</span><span class="o">@</span><span class="p">{{</span> <span class="n">people</span> <span class="p">}}</span> <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>such that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>modernmeerkat: !hug person1 person2 person3
</pre></div>
</div>
<p>results in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bot</span><span class="p">:</span> <span class="nd">@modernmeerkat</span> <span class="n">sends</span> <span class="n">hugs</span> <span class="n">to</span> <span class="nd">@person1</span> <span class="nd">@person2</span> <span class="nd">@person3</span>
</pre></div>
</div>
</section>
<section id="announcing-websites">
<h3>Announcing Websites<a class="headerlink" href="#announcing-websites" title="Permalink to this heading">¶</a></h3>
<p>You may want to add support for announcing the website data as part of the Twitchbot
track announcement.  You can pick and choose which websites are printed by taking
the following code snippet and modifying as necessary:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">artistwebsites</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">website</span> <span class="k">in</span> <span class="nv">artistwebsites</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">if</span> <span class="s1">&#39;bandcamp&#39;</span> <span class="k">in</span> <span class="nv">website</span> <span class="cp">%}</span><span class="x"> |Bandcamp: </span><span class="cp">{{</span> <span class="nv">website</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">elif</span> <span class="s1">&#39;discogs&#39;</span> <span class="k">in</span> <span class="nv">website</span> <span class="cp">%}</span><span class="x"> | Discogs: </span><span class="cp">{{</span> <span class="nv">website</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">elif</span> <span class="s1">&#39;facebook&#39;</span> <span class="k">in</span> <span class="nv">website</span> <span class="cp">%}</span><span class="x"> | Facebook: </span><span class="cp">{{</span> <span class="nv">website</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">elif</span> <span class="s1">&#39;instagram&#39;</span> <span class="k">in</span> <span class="nv">website</span> <span class="cp">%}</span><span class="x"> | IG: </span><span class="cp">{{</span> <span class="nv">website</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">elif</span> <span class="s1">&#39;last.fm&#39;</span> <span class="k">in</span> <span class="nv">website</span> <span class="cp">%}</span><span class="x"> | last.fm: </span><span class="cp">{{</span> <span class="nv">website</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">elif</span> <span class="s1">&#39;musicbrainz&#39;</span> <span class="k">in</span> <span class="nv">website</span> <span class="cp">%}</span><span class="x"> | MusicBrainz: </span><span class="cp">{{</span> <span class="nv">website</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">elif</span> <span class="s1">&#39;twitter&#39;</span> <span class="k">in</span> <span class="nv">website</span> <span class="cp">%}</span><span class="x"> | Twitter: </span><span class="cp">{{</span> <span class="nv">website</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">elif</span> <span class="s1">&#39;wikipedia&#39;</span> <span class="k">in</span> <span class="nv">website</span> <span class="cp">%}</span><span class="x"> | Wikipedia: </span><span class="cp">{{</span> <span class="nv">website</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">elif</span> <span class="s1">&#39;youtube&#39;</span> <span class="k">in</span> <span class="nv">website</span> <span class="cp">%}</span><span class="x"> | YouTube: </span><span class="cp">{{</span> <span class="nv">website</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span><span class="x"> | Official homepage: </span><span class="cp">{{</span> <span class="nv">website</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">What's Now Playing</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../settings.html">Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">Source</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Outputs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="textoutput.html">Text Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="discord.html">Discord</a></li>
<li class="toctree-l2"><a class="reference internal" href="obswebsocket.html">OBS WebSocket Plug-in</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">TwitchBot</a></li>
<li class="toctree-l2"><a class="reference internal" href="webserver.html">Webserver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../requests.html">User Track Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filter.html">Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../recognition/index.html">Music Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extras/index.html">Artist Extras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beam.html">Two-Computer Setup With Beam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quirks.html">Quirks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templatevariables.html">Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html#bug-reports-and-feature-requests">Bug Reports and Feature Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../comparisons.html">Versus Comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery.html">Gallery of Templates</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Outputs</a><ul>
      <li>Previous: <a href="obswebsocket.html" title="previous chapter">OBS WebSocket Plug-in</a></li>
      <li>Next: <a href="webserver.html" title="next chapter">Webserver</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021-2023, Allen Wittenauer.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/output/twitchbot.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>